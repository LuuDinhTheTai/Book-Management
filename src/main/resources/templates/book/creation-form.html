<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>BM - Create Book</title>
    <link rel="stylesheet" th:href="@{/style.css}"/>
    <link rel="icon"
          href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ“š</text></svg>">
</head>
<body>
<div th:replace="component/navbar :: navbar"></div>

<div class="container">
    <h1 class="page-title">Create Book</h1>

    <div th:if="${errorMessage}" class="error">
        <p th:text="${errorMessage}"></p>
    </div>

    <form th:action="@{/books/create}" th:object="${createBookRequest}" method="post" class="form" enctype="multipart/form-data">
        <label>Name:</label>
        <input name="name" type="text" th:value="${name}"/>
        <div th:if="${#fields.hasErrors('name')}" class="error" th:errors="*{name}"></div>
        <br>

        <label>Price:</label>
        <input name="price" type="number" step="0.01" th:value="${createBookRequest?.price}"/>
        <div th:if="${#fields.hasErrors('price')}" class="error" th:errors="*{price}"></div>
        <br>

        <label>Quantity:</label>
        <input name="qty" type="number" th:value="${createBookRequest?.qty}"/>
        <div th:if="${#fields.hasErrors('qty')}" class="error" th:errors="*{qty}"></div>
        <br>

        <label>Status:</label>
        <select name="status">
            <option value="" disabled selected>Choose status</option>
            <option th:each="status : ${statuses}"
                    th:value="${status}"
                    th:text="${status}"
                    th:selected="${createBookRequest?.status == status}">
            </option>
        </select>
        <div th:if="${#fields.hasErrors('status')}" class="error" th:errors="*{status}"></div>
        <br>

        <label>Categories:</label>
        <div class="category-selection">
            <div th:each="category : ${categories}" class="category-checkbox">
                <input type="checkbox"
                       name="categories"
                       th:value="${category.id}"
                       th:id="'category-' + ${category.id}"/>
                <label th:for="'category-' + ${category.id}" th:text="${category.name}"></label>
            </div>
        </div>
        <div th:if="${#fields.hasErrors('categories')}" class="error" th:errors="*{categories}"></div>
        <br>

        <div class="file-upload-section">
            <label>Cover Image:</label>
            <input name="coverImageFile" type="file" accept="image/*"/>
            <small>Upload a cover image for the book (JPG, PNG, GIF)</small>
        </div>

        <div class="file-upload-section">
            <label>Book PDF:</label>
            <input name="bookFile" type="file" accept="application/pdf"/>
            <small>Upload the book PDF file</small>
        </div>

        <fieldset>
            <legend>Detail</legend>
            <label>ISBN:</label>
            <input th:field="*{detail.isbn}" type="text"/>
            <div th:if="${#fields.hasErrors('detail.isbn')}" class="error" th:errors="*{detail.isbn}"></div>
            <br>

            <label>Title:</label>
            <input th:field="*{detail.title}" type="text"/>
            <div th:if="${#fields.hasErrors('detail.title')}" class="error" th:errors="*{detail.title}"></div>
            <br>

            <label>Subtitle:</label>
            <input th:field="*{detail.subtitle}" type="text"/>
            <div th:if="${#fields.hasErrors('detail.subtitle')}" class="error" th:errors="*{detail.subtitle}"></div>
            <br>

            <label>Author:</label>
            <input th:field="*{detail.author}" type="text"/>
            <div th:if="${#fields.hasErrors('detail.author')}" class="error" th:errors="*{detail.author}"></div>
            <br>

            <label>Publisher:</label>
            <input th:field="*{detail.publisher}" type="text"/>
            <div th:if="${#fields.hasErrors('detail.publisher')}" class="error" th:errors="*{detail.publisher}"></div>
            <br>

            <label>Published Date:</label>
            <input th:field="*{detail.publishedDate}" type="datetime-local"/>
            <div th:if="${#fields.hasErrors('detail.publishedDate')}" class="error"
                 th:errors="*{detail.publishedDate}"></div>
            <br>

            <label>Description:</label>
            <textarea th:field="*{detail.description}" rows="4" cols="50"></textarea>
            <div th:if="${#fields.hasErrors('detail.description')}" class="error"
                 th:errors="*{detail.description}"></div>
            <br>

            <label>Page Count:</label>
            <input th:field="*{detail.pageCount}" type="text"/>
            <div th:if="${#fields.hasErrors('detail.pageCount')}" class="error" th:errors="*{detail.pageCount}"></div>
            <br>

            <label>Language:</label>
            <select th:field="*{detail.language}">
                <option value="" disabled selected>Choose language</option>
                <option th:each="lang : ${languages}"
                        th:value="${lang}"
                        th:text="${lang}">
                </option>
            </select>
            <div th:if="${#fields.hasErrors('detail.language')}" class="error" th:errors="*{detail.language}"></div>
            <br>

            <label>Format:</label>
            <select th:field="*{detail.format}">
                <option value="" disabled selected>Choose format</option>
                <option th:each="fmt : ${formats}"
                        th:value="${fmt}"
                        th:text="${fmt}">
                </option>
            </select>
            <div th:if="${#fields.hasErrors('detail.format')}" class="error" th:errors="*{detail.format}"></div>
            <br>
        </fieldset>
        <button type="submit">Create</button>
    </form>

</div>
</body>
</html>